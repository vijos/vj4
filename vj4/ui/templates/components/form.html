{% macro form_attr(form_class) %}
  {% set extra_class = kwargs.pop('extra_class', None) %}
  {% set disabled = kwargs.pop('disabled', false) %}
  {% set required = kwargs.pop('required', false) %}
  {% set autofocus = kwargs.pop('autofocus', false) %}
  class="{{ form_class }}{% if extra_class %} {{ extra_class }}{% endif %}"
  {% if disabled %}disabled{% endif %}
  {% if required %}required{% endif %}
  {% if autofocus %}autofocus data-autofocus{% endif %}
{% endmacro %}

{% macro select(options, name='', value='') %}
<select
  name="{{ name }}"
  {{ form_attr('select', **kwargs) }}
>
{% for k, v in options %}
  <option value="{{ k }}"{% if value == k %} selected{% endif %}>
    {{ _(v) }}
  </option>
{% endfor %}
</select>
{% endmacro %}

{% macro text(name='', value='', placeholder='', type='text') %}
<input
  type="{{ type }}"
  name="{{ name }}"
  value="{{ value }}"
  placeholder="{{ placeholder }}"
  {{ form_attr('textbox', **kwargs) }}
>
{% endmacro %}

{% macro textarea(name='', value='', placeholder='') %}
<textarea
  name="{{ name }}"
  placeholder="{{ placeholder }}"
  {{ form_attr('textbox', **kwargs) }}
>{{ value }}</textarea>
{% endmacro %}

{% macro render_row(type, label, help_text=None, columns=None) %}
<div class="row"><div class="medium-{{ columns|default(8 if type == 'textarea' else 5, true) }} columns">
  <label>
    {{ _(label) }}
  {% if kwargs.required %}
    (required)
  {% endif %}
  {% if type == 'text' %}
    {{ text(**kwargs) }}
  {% elif type == 'password' %}
    {{ text(type='password', **kwargs) }}
  {% elif type == 'select' %}
    {{ select(**kwargs) }}
  {% elif type == 'textarea' %}
    {{ textarea(**kwargs) }}
  {% endif %}
  </label>
{% if help_text %}
  <p class="help-text">{{ _(help_text) }}</p>
{% endif %}
</div></div>
{% endmacro %}

{% macro render(rows) %}
{% for input in rows %}
  {{ render_row(**input) }}
{% endfor %}
{% endmacro %}
